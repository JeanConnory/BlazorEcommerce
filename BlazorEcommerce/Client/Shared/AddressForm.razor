@inject IAddressService AddressService

@if(address == null)
{
	<span>You haven't specified a delivery address, yet.
	<button class="btn" @onclick="InitAddress">Add an address?</button></span>
}
else if(!editAddress)
{
	<p>
		<span>@address.FirstName @address.LastName</span><br />
		<span>@address.Street</span><br />
		<span>@address.City, @address.State, @address.Zip</span><br />
		<span>@address.Country</span><br />
	</p>
	<button class="btn btn-primary" @onclick="EditAddress">Edit</button>
}
else
{
	<EditForm Model="address" OnSubmit="SubmitAddress">
		<div class="mb-3">
			<label for="firstname">First Name</label>
			<inputText id="firstname" @bind="address.FirstName" class="form-control" />
		</div>
		<div class="mb-3">
			<label for="lastname">Last Name</label>
			<inputText id="lastname" @bind="address.LastName" class="form-control" />
		</div>
		<div class="mb-3">
			<label for="street">Street</label>
			<inputText id="street" @bind="address.Street" class="form-control" />
		</div>
		<div class="mb-3">
			<label for="city">City</label>
			<inputText id="city" @bind="address.City" class="form-control" />
		</div>
		<div class="mb-3">
			<label for="state">State</label>
			<inputText id="state" @bind="address.State" class="form-control" />
		</div>
		<div class="mb-3">
			<label for="zip">Zip/Postal Code</label>
			<inputText id="zip" @bind="address.Zip" class="form-control" />
		</div>
		<div class="mb-3">
			<label for="country">Country</label>
			<inputText id="country" @bind="address.Country" class="form-control" />
		</div>
		<button type="submit" class="btn btn-primary">Save</button>
	</EditForm>
}

@code {
	Address address = null;
	bool editAddress = false;

	protected override async Task OnInitializedAsync()
	{
		address = await AddressService.GetAddress();
	}

	private async Task SubmitAddress()
	{
		editAddress = false;
		address = await AddressService.AddOrUpdateAddress(address);
	}

	private void InitAddress()
	{
		address = new Address();
		editAddress = true;
	}

	private void EditAddress()
	{
		editAddress = true;
	}
}
